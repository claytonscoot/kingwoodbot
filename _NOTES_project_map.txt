üß≠ Astro Outdoor Designs ‚Äì Fence Assistant
Folder: kingwoodbot/

‚öôÔ∏è PROJECT OVERVIEW
This project is a self-contained fence quote chatbot and lead capture web app built with:

Frontend: HTML/CSS/JS (chat.html, admin.html)
Backend: FastAPI (main.py)
Hosting: Render.com (always-on, no local server needed)
AI: Claude (claude-haiku-4-5) via Anthropic API
Lead Storage: Google Sheets (permanent) + local CSV (temporary fallback)
Email Alerts: Brevo SMTP on every lead submission
Local legacy script: start.bat (no longer needed ‚Äî kept for reference only)

Users can chat to describe their project, get a working estimate, and submit a quote request.
Submitted leads are saved to Google Sheets and emailed to admin@astrooutdoordesigns.com.

üìÇ FILE STRUCTURE & PURPOSE
File / Folder       Description
main.py             FastAPI backend. Handles /chat, /lead, /admin, /live-quote, etc.
                    Saves leads to Google Sheets (permanent) and leads.csv (temp/Render disk).
                    Sends Brevo email notification on every lead. Uses Claude AI for chat.
chat.html           Public chat interface. Customer describes project, gets estimates,
                    submits quote request. Calls /chat and /lead endpoints.
admin.html          Internal dashboard. Displays stats and recent leads via GET /admin/data.
leads.csv           Local CSV fallback (ephemeral on Render ‚Äî resets on redeploy).
                    Real permanent storage is Google Sheets.
start.bat           Legacy Windows batch file. No longer needed ‚Äî app runs on Render 24/7.
_NOTES_project_map.txt  This file.

üîå API ENDPOINTS SUMMARY
Endpoint        Method  Description
/               GET     Serves chat.html
/chat           POST    Claude AI conversation endpoint for fence inquiries
/lead           POST    Saves lead to Google Sheets + CSV, sends Brevo email alert
/admin          GET     Serves admin.html dashboard
/admin/data     GET     Returns recent lead data & stats as JSON
/admin/leads    GET     Returns full lead list as JSON
/live-quote     POST    Flags priority callback requests
/contact-info   GET     Returns public business info
/health         GET     Server health check

üß† BACKEND FEATURES
- Session tracking: Each chat session gets its own ID (message history stored in memory)
- Google Sheets: All leads permanently saved to Sheet ID 1RodpbvL75F8AZxutqKcTY_vrbxZvylSBv1SggglPGlM
- Brevo email: Instant notification to admin@astrooutdoordesigns.com on every submission
- CSV fallback: Local leads.csv (note: wiped on Render redeploy ‚Äî not reliable long-term)
- Console logging: Lead details printed to Render logs on submission
- Health check: /health confirms server status

üîê ENVIRONMENT VARIABLES (set in Render dashboard)
ANTHROPIC_API_KEY           Claude AI API key
BREVO_API_KEY               Brevo email service API key
BREVO_FROM_EMAIL            forms@astrooutdoordesigns.com
LEAD_NOTIFY_EMAIL           admin@astrooutdoordesigns.com
GOOGLE_SERVICE_ACCOUNT_JSON Full JSON contents of Google service account key file
PORT                        10000

üìä GOOGLE SHEETS
Sheet URL: https://docs.google.com/spreadsheets/d/1RodpbvL75F8AZxutqKcTY_vrbxZvylSBv1SggglPGlM
Service Account: kingwoodbot-sheets@wp-mail-smtp-gmail-455419.iam.gserviceaccount.com
Columns: timestamp, ip, name, phone, email, address_or_zip, preferred_contact,
         project_details, session_id, status

üöÄ DEPLOYMENT
- Hosted on Render.com (service: astro-fence-assistant)
- Auto-deploys from GitHub (repo: claytonscoot/kingwoodbot, branch: main)
- Any commit to main triggers a redeploy automatically
- No need to run start.bat or anything locally

üñ•Ô∏è LOCAL DEVELOPMENT (if needed)
- pip install fastapi uvicorn requests aiofiles pydantic[email] cryptography
- Set environment variables manually or via .env file
- uvicorn main:app --reload --port 8000
- Visit http://localhost:8000

‚úÖ FUTURE IMPROVEMENTS
[ ] Admin authentication for /admin route
[ ] Filter/search leads in admin dashboard
[ ] Save chat sessions to Google Sheets for review
[ ] Mark leads as contacted/closed in Sheets
[ ] Optional SMS alerts via Twilio
